### ------------- [          ORDER OF INSERT         ]------------ ###
# 1-0. Account (Household)
# 1-1. Contact - Household Members
# 1-2. Pricebook2 (Imported)
# 1-3. Product2 (Imported)
# 1-4. PricebookEntry (Imported)
# 1-7. Opportunity 
# 1-8. OpportunityLineItem
# 1-5. Membership__c
# 1-6. Membership_Contact_Role__c 


### ----------- [ MembershipSchemaAndBenefits_basic.recipe.yml Summary ]---------- ###
# Household Account with multiple contacts and a single contact, Organication Account without primary contact 
# Query Standard Price Book
# Create [3] products called "Individual Membership", "Houshold Membership", "Corporate Membership"
# Membership record is specific to a related account and opportunity records.
# Membership Contact role differenciates household members roles among the same membership.
# There is an apex trigger handler that creates a membership contact role for primary contact.
# https://github.com/SFDO-Community-Sprints/MembershipSchemaAndBenefits


### ----------- [               CLI RUN                ]---------- ###

# cci task run generate_and_load_from_yaml --generator_yaml snowfakery_samples/OSC/MembershipSchemaAndBenefits_basic.recipe.yml --num_records 300 --num_records_tablename npe03__Recurring_Donation__c --org qa
# snowfakery --output-format json --output-file src/foo.json snowfakery_samples/OSC/MembershipSchemaAndBenefits_basic.recipe.yml

### ----------- [            Recipe Starts             ]---------- ###

# Import Pricebook, Product, Price Book Entry
- include_file: MembershipSchemaAndBenefits_PricebookProducts.recipe.yml

- object: Account
  fields:

  # MembershipSchemaAndBenefits custom fields
    First_Membership_Start_Date__c: DATE
    Membership_End_Date__c: DATE
    Membership_Status__c: PICKLIST
    Membership_Type__c: PICKLIST
    Primary_Membership__c: REFERENCE


- object: Contact
  fields:
    # MembershipSchemaAndBenefits custom fields
    Last_Membership_Start_Date__c: DATE
    First_Membership_Start_Date__c: DATE
    Membership_End_Date__c: DATE
    Membership_Status__c: PICKLIST
    Membership_Type__c: PICKLIST

- object: Membership__c
  fields:
    Name: STRING

    Start_Date__c: DATE
    End_Date__c: DATE
    Type__c: PICKLIST
    Origin__c: PICKLIST

    Account__c: REFERENCE
    Opportunity__c: REFERENCE
    Primary_Contact__c: REFERENCE
    Product__c: REFERENCE


- object: Membership_Contact_Role__c
  fields:
    Name: STRING
    Start_Date__c: DATE
    End_Date__c: DATE
    Role__c: PICKLIST

    Is_Primary__c: BOOLEAN

    Membership__c: REFERENCE
    Contact__c: REFERENCE

- object: Opportunity
  fields:

- object: OpportunityLineItem
  fields:
    Name: STRING(Automated)
    Quantity: DOUBLE

    UnitPrice:  CURRENCY
    Description: STRING

    Membership__c: REFERENCE
    OpportunityId: REFERENCE
    PricebookEntryId: 
      reference: PricebookEntryId
    Product2Id: REFERENCE
    ProductCode: STRING

- object: Membership__c
  fields:

- object: Opportunity
  fields:
    AccountId:
      reference: Account # you need to have declared an account elsewhere
    Name:
      fake: name
    Description:
      fake.text:
        max_nb_chars: 100
    CloseDate:
      date_between:
        start_date: -1y
        end_date: today
    StageName:
      random_choice:
        - Prospecting
        - Qualification
        - Needs Analysis
        - Value Proposition
        - Id. Decision Makers
        - Perception Analysis
        - Proposal/Price Quote
        - Negotiation/Review
        - Closed Won
        - Closed Lost
        - Pledged
    Amount:
      random_number:
        min: 1
        max: 100000
    ContactId:
      reference: Contact
    npe01__Contact_Id_for_Role__c:
      fake.text:
        max_nb_chars: 100
    npe01__Member_Level__c:
      random_choice:
        - Gold
        - Silver
        - Bronze
    npe01__Membership_End_Date__c:
      date_between:
        start_date: -1y
        end_date: today
    npe01__Membership_Origin__c:
      random_choice:
        - New
        - Renewal
        - Reacquire
    npe01__Membership_Start_Date__c:
      date_between:
        start_date: -1y
        end_date: today